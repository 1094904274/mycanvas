<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <style>
        body{
            padding:0;margin:0;
        }
        canvas{
            background: #eee;
        }
    </style>
    <script>
        window.onload=function(){
            var canvas=document.querySelector("canvas");
            var cobj=canvas.getContext("2d");
            var arr=[];


            canvas.onmousedown=function(e){
                var ox= e.offsetX;
                var oy= e.offsetY;
                canvas.onmousemove=function(e){
                    var movex= e.offsetX;
                    var movey= e.offsetY;
                    cobj.clearRect(0,0,canvas.width,canvas.height);
                    if(arr.length>0) {
                        cobj.putImageData(arr[arr.length - 1],0,0);
                    }
                    cobj.beginPath();
                    cobj.moveTo(ox,oy);
                    cobj.lineTo(movex,movey);
                    cobj.stroke();
                }
                canvas.onmouseup=function(){
                    arr.push(cobj.getImageData(0,0,canvas.width,canvas.height));
                    canvas.onmousemove=null;
                    canvas.onmouseup=null;
                }
            }



            canvas.onmousedown=function(e){
                var ox= e.offsetX;
                var oy= e.offsetY;
                canvas.onmousemove=function(e){
                    var movex= e.offsetX;
                    var movey= e.offsetY;
                    cobj.clearRect(0,0,canvas.width,canvas.height);
                    if(arr.length>0) {
                        cobj.putImageData(arr[arr.length - 1],0,0);
                    }
                    cobj.beginPath();
                    cobj.rect(ox,oy,movex-ox,movey-oy);
                    cobj.stroke();
                }
                canvas.onmouseup=function(){
                    arr.push(cobj.getImageData(0,0,canvas.width,canvas.height));
                    canvas.onmousemove=null;
                    canvas.onmouseup=null;
                }
            }

        }
    </script>
</head>
<body>
<canvas width="600" height="600">

</canvas>
</body>
</html>